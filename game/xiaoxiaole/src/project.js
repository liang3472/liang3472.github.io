require=function t(e,s,i){function a(c,o){if(!s[c]){if(!e[c]){var r="function"==typeof require&&require;if(!o&&r)return r(c,!0);if(n)return n(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var h=s[c]={exports:{}};e[c][0].call(h.exports,function(t){var s=e[c][1][t];return a(s?s:t)},h,h.exports,t,e,s,i)}return s[c].exports}for(var n="function"==typeof require&&require,c=0;c<i.length;c++)a(i[c]);return a}({BaseDialog:[function(t,e,s){"use strict";cc._RFpush(e,"d92636jtC9Pqpwd+5My033T","BaseDialog");var i=t("GameStatus"),a=t("Utils");cc.Class({"extends":cc.Component,properties:{close:cc.Button,bg:cc.Node,plane:cc.Node},init:function(t){this.game=t},closeClick:function(){this.dimiss()},show:function(){this.game.switchGameStatus(i.DIALOG),this.node.setLocalZOrder(210),this.node.active=!0,this.node.opacity=255,this._doStartAnim()},dimiss:function(){this.game.switchGameStatus(i.SHOWSTARTBTN),this._doEndAnim()},_doStartAnim:function(){if(a.shouldRender()){this.plane.scale=.8;var t=cc.scaleTo(.5,1,1);this.plane.runAction(t.easing(cc.easeElasticOut(0)))}},_doEndAnim:function(){var t=this;if(a.shouldRender()){var e=cc.fadeOut(.1),s=cc.callFunc(function(){return t.node.active=!1});this.node.runAction(cc.sequence(e,s))}else this.node.active=!1}}),cc._RFpop()},{GameStatus:"GameStatus",Utils:"Utils"}],DialogManager:[function(t,e,s){"use strict";cc._RFpush(e,"c28c2TQPK1O3ryv/or7dHzb","DialogManager");var i=t("ResultDialog"),a=t("StartDialog");cc.Class({"extends":cc.Component,properties:{resultDialog:cc.Prefab,startDialog:cc.Prefab},init:function(t){this._resultDialog=this._getDialogNode(this.resultDialog).getComponent(i),this._startDialog=this._getDialogNode(this.startDialog).getComponent(a),this._resultDialog.init(t),this._startDialog.init(t)},_getDialogNode:function(t){var e=cc.instantiate(t);return this.node.parent.addChild(e),e.active=!1,e},getResultDialog:function(){return this._resultDialog},getStartDialog:function(){return this._startDialog}}),cc._RFpop()},{ResultDialog:"ResultDialog",StartDialog:"StartDialog"}],GameManager:[function(t,e,s){"use strict";cc._RFpush(e,"3ae58Pl/4VJ4JUbwlQ7Qx5b","GameManager");var i=t("PlaneManager"),a=t("SquaresManager"),n=t("TimeManager"),c=t("GameStatus"),o=t("ScoreManager"),r=t("DialogManager");cc.Class({"extends":cc.Component,properties:{planeMng:i,squaresMng:a,timeMng:n,scoreMng:o,dialogMng:r},onLoad:function(){this.squaresMng.init(this),this.planeMng.init(this),this.timeMng.init(this),this.scoreMng.init(this),this.dialogMng.init(this),this.switchGameStatus(c.SHOWSTARTBTN),cc.director.setDisplayStats(!0)},switchGameStatus:function(t){switch(this._gameStatus=t,t){case c.SHOWSTARTBTN:cc.log("SHOWSTARTBTN"),this.scoreMng.setScore(0),this.planeMng.flushPlane(),this.startGame();break;case c.DIALOG:cc.log("DIALOG");break;case c.GAMEOVER:cc.log("GAMEOVER"),this.dialogMng.getResultDialog().showResult();break;case c.PLAYING:cc.log("PLAYING"),this.timeMng.oneSchedule()}},startGame:function(){this.switchGameStatus(c.PLAYING)},getGameState:function(){return this._gameStatus},gameOver:function(){this.switchGameStatus(c.GAMEOVER),this.dialogMng.getResultDialog().showResult()}}),cc._RFpop()},{DialogManager:"DialogManager",GameStatus:"GameStatus",PlaneManager:"PlaneManager",ScoreManager:"ScoreManager",SquaresManager:"SquaresManager",TimeManager:"TimeManager"}],GamePlane:[function(t,e,s){"use strict";cc._RFpush(e,"1b71brLRz1DPI0SCdHl9Gp/","GamePlane"),cc.Class({"extends":cc.Component,properties:{},init:function(t){this.game=t},setPlaneSize:function(t,e){this.node.width=t,this.node.height=e}}),cc._RFpop()},{}],GameStatus:[function(t,e,s){"use strict";cc._RFpush(e,"58e57wbQ75CwrhnR8q9Asp9","GameStatus");var i=cc.Enum({SHOWSTARTBTN:-1,PLAYING:-1,GAMEOVER:-1,DIALOG:-1});e.exports=i,cc._RFpop()},{}],PlaneManager:[function(t,e,s){"use strict";cc._RFpush(e,"e5496hamndHNr2JOLMSWHSB","PlaneManager");var i=t("GamePlane");cc.Class({"extends":cc.Component,properties:{planeSize:cc.Vec2,plane:i},init:function(t){this.game=t,this.plane.init(t)},flushPlane:function(){this._width=this.game.squaresMng.squaresSize.x*this.planeSize.x,this._height=this.game.squaresMng.squaresSize.y*this.planeSize.y,this.plane.setPlaneSize(this._width,this._height),this.game.squaresMng.generateMap(this.planeSize.x,this.planeSize.y),this.game.squaresMng.renderMap(this.plane.node,this._width,this._height)}}),cc._RFpop()},{GamePlane:"GamePlane"}],ResultDialog:[function(t,e,s){"use strict";cc._RFpush(e,"c86e8zMLChFfamPX2wpcIsK","ResultDialog");var i=t("BaseDialog");cc.Class({"extends":i,properties:{},showResult:function(){this.show()}}),cc._RFpop()},{BaseDialog:"BaseDialog"}],ScoreManager:[function(t,e,s){"use strict";cc._RFpush(e,"567d7PxqIlHkrGstecwXCrs","ScoreManager");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{score:cc.Label},init:function(t){this.game=t,this._score=0},getScore:function(){return this._score},setScore:function(t){this._score=t,this._updateScore()},addScore:function(){this._score+=1,this._updateScore()},_updateScore:function(){this.score.string=i.prefixInteger(this._score,3)}}),cc._RFpop()},{Utils:"Utils"}],SquaresManager:[function(t,e,s){"use strict";cc._RFpush(e,"a8b57tDSxRA+Kv859xW8Jy6","SquaresManager"),cc.Class({"extends":cc.Component,properties:{blueSquares:cc.Prefab,greenSquares:cc.Prefab,redSquares:cc.Prefab,yellowSquares:cc.Prefab,squaresSize:cc.Vec2},init:function(t){this.game=t,this.firstFocus=null,this.secondFocus=null},getSquaresRect:function(){return this.squaresSize},getSquaresTypeList:function(){return[this.blueSquares,this.greenSquares,this.redSquares,this.yellowSquares]},generateMap:function(t,e){this._row=t,this._col=e,this.pairCount=0,this._maps=[this._row];for(var s=0,i=0;i<this._row;i++){this._maps[i]=[this._col];for(var a=0;a<this._col;a++)(i*this._row+a)%2===0&&(s=this.createId()),this._maps[i][a]=s}this.change(),this.testMap()},change:function(){for(var t,e,s,i=0;i<this._row;i++)for(var a=0;a<this._col;a++)t=parseInt(cc.random0To1()*(this._row-1)),e=parseInt(cc.random0To1()*(this._col-1)),s=this._maps[i][a],this._maps[i][a]=this._maps[t][e],this._maps[t][e]=s},createId:function(){var t=this.pairCount%this.getSquaresTypeList().length;return this.pairCount+=1,t},renderMap:function(t,e,s){this.resetFocus(),this.clearAllSquares(t);for(var i=0;i<this._row;i++)for(var a=0;a<this._col;a++){var n=this.getSquaresTypeList(),c=n[this._maps[i][a]],o=cc.instantiate(c);o.width=this.squaresSize.x,o.height=this.squaresSize.y,t.addChild(o);var r=a*this.squaresSize.x+this.squaresSize.x/2-e/2,u=-i*this.squaresSize.y-this.squaresSize.y/2+s/2;o.setPosition(cc.p(r,u));var h=o.getComponent("Square");h.init(this.game),h.setId(this._maps[i][a]),h.setMapPlace(i,a)}},checkABFocus:function(t){null!==this.secondFocus?this.secondFocus!==t&&this.firstFocus!==t&&(this.firstFocus.clearFocus(),this.secondFocus.clearFocus(),this.resetFocus(),this.firstFocus=t):null!==this.firstFocus?this.firstFocus!==t&&this.firstFocus.getId()===t.getId()?(this.firstFocus.destorySquare(),this.firstFocus=null,this.game.scoreMng.addScore(),t.destorySquare(),t=null,this.addScore()):this.firstFocus!==t&&(this.secondFocus=t):this.firstFocus=t},addScore:function(){this.pairCount-=1,cc.log("消除一对 +1分"),0===this.pairCount&&this.game.planeMng.flushPlane()},resetFocus:function(){this.firstFocus=null,this.secondFocus=null},clearAllSquares:function(t){t.removeAllChildren()},testMap:function(){for(var t=0;t<this._row;t++){for(var e="",s=0;s<this._col;s++)e+=this._maps[t][s];cc.log(e),cc.log("")}}}),cc._RFpop()},{}],Square:[function(t,e,s){"use strict";cc._RFpush(e,"d94b269redAPLhwhXn0T5R2","Square");var i=t("GameStatus");cc.Class({"extends":cc.Component,properties:{focusBg:cc.Node},init:function(t){var e=this;this.game=t,this.item={id:-1,row:-1,col:-1,isFocus:!1,focusBg:this.focusBg},this.node.on(cc.Node.EventType.TOUCH_END,function(){e.game.getGameState()===i.PLAYING&&(e.print(),e.toggleFocusState(!0),e.game.squaresMng.checkABFocus(e))},this)},setMapPlace:function(t,e){this.item._row=t,this.item._col=e},setId:function(t){this.item.id=t},getId:function(){return this.item.id},toggleFocusState:function(t){this.item._isFocus=t,this.item.focusBg.active=t,t?this.node.setLocalZOrder(100):this.node.setLocalZOrder(0)},clearFocus:function(){this.toggleFocusState(!1)},isFocusStatus:function(){return this.item._isFocus},destorySquare:function(){this.node.destroy()},print:function(){cc.log("test touch ["+this.item._row+"]["+this.item._col+"]")}}),cc._RFpop()},{GameStatus:"GameStatus"}],StartDialog:[function(t,e,s){"use strict";cc._RFpush(e,"bffdfgJYUJJr4eRV/8vJxVg","StartDialog");var i=t("BaseDialog");cc.Class({"extends":i,properties:{},showStart:function(){this.show()}}),cc._RFpop()},{BaseDialog:"BaseDialog"}],TimeManager:[function(t,e,s){"use strict";cc._RFpush(e,"e4af9nXKtlPcrVdcGyOUx6A","TimeManager");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{maxTime:0,leftCount:cc.Label,rightCount:cc.Label},init:function(t){this.game=t,this.time=this.maxTime},_countCallback:function(){this.counting=!1,this.leftCount.string="30",this.rightCount.string="00",this.game.gameOver()},stopCounting:function(){this.unschedule(this._countCallback),this.time=this.maxTime},oneSchedule:function(){this.stopCounting(),this.scheduleOnce(this._countCallback,this.maxTime),this.counting=!0},update:function(t){if(this.counting&&this.time>0){this.time-=t;var e=this.time.toFixed(2);4===e.length&&(e="0"+e);var s=e.split(".");this.leftCount.string=s[0],this.rightCount.string=i.prefixInteger((.6*s[1]).toFixed(0),2)}}}),cc._RFpop()},{Utils:"Utils"}],Utils:[function(t,e,s){"use strict";cc._RFpush(e,"20fdfJFMHtC8KlLHTVOrlE+","Utils"),e.exports={prefixInteger:function(t,e){return(Array(e).join("0")+t).slice(-e)},isWeChatBrowser:function(){return/MicroMessenger/i.test(navigator.userAgent)},isElemeBrowser:function(){return/Eleme/i.test(navigator.userAgent)},isWeiBoBrowser:function(){return/WeiBo/i.test(navigator.userAgent)},scanCookie:function(t){var e,s=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(s))?unescape(e[2]):null},preLoadSpriteFrame:function(t,e){cc.loader.loadRes(t,cc.SpriteFrame,function(t,s){e.spriteFrame=s})},shouldRender:function(){return this.isWeChatBrowser()||cc.sys.os===cc.sys.OS_IOS}},cc._RFpop()},{}]},{},["GamePlane","Utils","GameManager","ScoreManager","GameStatus","SquaresManager","StartDialog","DialogManager","ResultDialog","BaseDialog","Square","TimeManager","PlaneManager"]);